## 이차원 이산형 확률변수
2개의 불공정한 주사위를 사용한다고 가정

## 1. 2차원 이산형 확률변수의 정의


### 1.1 결합확률분포 (joint probability distribution)
1차원 확률분포 X, Y를 동시에 다루며 이둘이 취할 수 있는 조합으로 이루어진 집합과 그 확률분포를 결합확률분포라고함


-$P(X=x, Y=y) = f_xy(x,y)$ 

### 1.2 확률의 성질
1) 2차원 이산형 확률도 1차원의 경우와 마찬가지로 확률은 0이상
2) 전체 확률은 1이 되어야한다

- $f_(xy)(x_i, y_i) >= 0$
- $\sum{i}\sum{j}f_xy(x_i,y_i) = 1$


``` python
x_set = np.arange(2, 13)
y_set = np.arange(1, 7)

def f_XY(x, y): #확률정의
    if 1 <= y <=6 and 1 <= x - y <= 6:
        return y * (x-y) / 441
    else:
        return 0

XY = [x_set, y_set, f_XY]

prob = np.array([[f_XY(x_i, y_j) for y_j in y_set]
                 for x_i in x_set])

fig = plt.figure(figsize=(10, 8))
ax = fig.add_subplot(111)

c = ax.pcolor(prob)
ax.set_xticks(np.arange(prob.shape[1]) + 0.5, minor=False)
ax.set_yticks(np.arange(prob.shape[0]) + 0.5, minor=False)
ax.set_xticklabels(np.arange(1, 7), minor=False)
ax.set_yticklabels(np.arange(2, 13), minor=False)

# y축을 내림차순의 숫자가 되게 하여, 위 아래를 역전시킨다
ax.invert_yaxis()

# x축의 눈금을 그래프 위쪽에 표시
ax.xaxis.tick_top()
fig.colorbar(c, ax=ax)
plt.show()
```

``` python
# 확률성질 체크
np.all(prob >= 0)
np.sum(prob)
```


### 1.3 주변확률분포 (marginal probability distribution)
- 결합확률분포를 사용할 경우 동시에 확률변수 2개를 고려하게 됨
- 따라서 개별 확률분포가 궁금할 경우 주변 확률분포를 사용

**확률변수 X의 확률함수 $F_X(x)$ 는 결합함수 $f_XY$ 에서 Y가 취할 수 있는 값 모두를 대입한 다음 모두 더한 값으로 구할 수 있다**


- $\sum{k}f_XY(x, y_k)$  --> 이를 $f_X(x)$를 X의 주변확률분포라고 함
- 이렇게 결합확률함수 $f_XY$ 에서 Y값의 영향력을 제거한다고 보면 쉬움


``` python
# 여기서 f_XY함수는 y*(x-y)/441
def f_X(x):
    return np.sum([f_XY(x, y_k) for y_k in y_set])

def f_Y(y):
    return np.sum([f_XY(x_k, y) for x_k in x_set])

X = [x_set, f_X]
Y = [y_set, f_Y]

prob_x = np.array([f_X(x_k) for x_k in x_set])
prob_y = np.array([f_Y(y_k) for y_k in y_set])

fig = plt.figure(figsize=(12, 4))
ax1 = fig.add_subplot(121)
ax2 = fig.add_subplot(122)

ax1.bar(x_set, prob_x)
ax1.set_title('X_marginal probability distribution')
ax1.set_xlabel('X_value')
ax1.set_ylabel('probability')
ax1.set_xticks(x_set)

ax2.bar(y_set, prob_y)
ax2.set_title('Y_marginal probability distribution')
ax2.set_xlabel('Y_value')
ax2.set_ylabel('probability')

plt.show()
```


> 결과


<img width="765" alt="스크린샷 2023-08-06 오후 8 48 53" src="https://github.com/hozyhozy/Statistics/assets/123252821/28b617ff-4383-47be-ae73-023901f617cc">


## 2. 2차원 이산형 확률변수의 지표

### 2.1 기댓값
$x_i$ 와 확률의 곱으로 표현 가능

- $\mu_{X} = E(X) = \sum{i}\sum{j}x_i * f_XY(x_i, y_j)$
- 기댓값의 선형성 : $E(aX+bY) = aE(X)+bE(Y)$


``` python
np.sum([x_i * f_XY(x_i, y_j) for x_i in x_set for y_j in y_set])

#확률변수 변환버전
def E(XY, g):
    x_set, y_set, f_XY = XY
    return np.sum([g(x_i, y_j) * f_XY(x_i, y_j)
                   for x_i in x_set for y_j in y_set])

mean_X = E(XY, lambda x, y: x)
mean_Y = E(XY, lambda x, y: y)

#선형성

a, b = 2, 3
E(XY, lambda x, y: a*x + b*y)
a * mean_X + b * mean_Y
```

### 2.2 분산
X에 대한 편차 제곱의 기댓값으로 표현 가능

- $\sigma^2_X = V(X) = \sum{i}\sum{j}(x_i - \mu{x})^2* f_(XY)(x_i, y_j)$


